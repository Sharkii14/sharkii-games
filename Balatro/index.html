<!doctype html>
<html lang="en-us">
<head>
  <!-- CHANGE THIS to your CDN path -->
  <base href="https://cdn.jsdelivr.net/gh/Sharkii14/sharkii-games@main/Balatro/">

  <meta charset="utf-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <title>Balatro</title>

  <!-- Styles -->
  <link rel="stylesheet" href="theme/love.css">

  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: black;
    }

    canvas {
      display: block;
    }
  </style>

  <script src="consolewrapper.js"></script>
</head>

<body tabindex="0">

  <canvas id="loadingCanvas"></canvas>
  <canvas id="canvas"></canvas>

  <script>
    const loadingCanvas = document.getElementById("loadingCanvas");
    const gameCanvas = document.getElementById("canvas");

    function resizeCanvases() {
      const w = window.innerWidth;
      const h = window.innerHeight;

      loadingCanvas.width = w;
      loadingCanvas.height = h;
      gameCanvas.width = w;
      gameCanvas.height = h;
    }

    window.addEventListener("resize", resizeCanvases);
    resizeCanvases();

    window.callad = () => {
      window.parent?.postMessage({ type: "adcall" }, "*");
    };

    const loadingContext = loadingCanvas.getContext("2d");

    function drawLoadingText(text) {
      loadingContext.fillStyle = "rgb(142,195,227)";
      loadingContext.fillRect(0, 0, loadingCanvas.width, loadingCanvas.height);
      loadingContext.fillStyle = "rgb(11,86,117)";
      loadingContext.font = "2em Arial";
      loadingContext.textAlign = "center";
      loadingContext.fillText(text, loadingCanvas.width / 2, loadingCanvas.height / 2);
    }

    var Module = {
      arguments: ["./game.love"],
      INITIAL_MEMORY: 256000000,
      canvas: gameCanvas,
      setStatus(text) {
        if (text) {
          drawLoadingText(text);
        } else {
          loadingCanvas.style.display = "none";
          gameCanvas.style.visibility = "visible";
        }
      },
      monitorRunDependencies(left) {
        this.setStatus(left ? `Loading… (${left})` : "");
      }
    };

    Module.setStatus("Downloading…");

    function applicationLoad() {
      Love(Module);
    }
  </script>

  <script src="game.js"></script>
  <script src="love.js" async onload="applicationLoad()"></script>

</body>
</html>
